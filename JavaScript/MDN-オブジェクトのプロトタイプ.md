*目次*
* [概要](#概要)
* [プロトタイプとは](#プロトタイプとは)
* [オブジェクトのプロパティにアクセスする時の検索順序](#オブジェクトのプロパティにアクセスする時の検索順序)
* [プロトタイプにアクセスする](#プロトタイプにアクセスする)
* [オブジェクトプロトタイプ](#オブジェクトプロトタイプ)
* [プロトタイプを自分で設定する](#プロトタイプを自分で設定する)

### 概要

本ページは以下の記事の内容をまとめたもの。

https://developer.mozilla.org/ja/docs/Learn/JavaScript/Objects/Object_prototypes

### プロトタイプとは

**すべてのオブジェクトはプロトタイプを持っている。**(そして、プロトタイプとは、すべての**オブジェクトに組み込まれているプロパティのこと。**)

また、プロトタイプそれ自体がオブジェクトでもあるので、**プロトタイプは自分自身でもプロトタイプを持っている。**

以下引用。
```
JavaScript ですべてのオブジェクトは、そのプロトタイプと呼ばれる組み込みプロパティを持っています。
プロトタイプはそれ自体がオブジェクトなので、プロトタイプは自分自身でプロトタイプを持ち、
プロトタイプチェーンと呼ばれるものを持ちます。
自分自身でプロトタイプにnullを持つプロトタイプに到達すると、その連鎖は終わります。
```

### オブジェクトのプロパティにアクセスする時の検索順序

オブジェクトのプロパティにアクセスする時は、以下の順序で検索が行われている。

```
オブジェクトのプロパティにアクセスしようとしたとき、オブジェクト自身にプロパティが見つからない場合は、
プロトタイプを検索してプロパティを探します。それでもプロパティが見つからない場合は、
プロトタイプのプロトタイプが検索され、プロパティが得られるか、
チェーンの終わりに達するか、その場合は undefined を返すまで、そのような具合に繰り返します。
```

### プロトタイプにアクセスする

オブジェクトのプロトタイプにアクセスには`Object.getPrototypeOf()`メソッドを使用する。

**使い方**

以下のように入力する。
```
Object.getPrototypeOf(オブジェクト名);
```

実行すると以下のように、このオブジェクトで利用できるすべてのプロパティの一覧が表示される。

```
/* 実行結果

constructor: ƒ Object()
hasOwnProperty: ƒ hasOwnProperty()
isPrototypeOf: ƒ isPrototypeOf()
propertyIsEnumerable: ƒ propertyIsEnumerable()
toLocaleString: ƒ toLocaleString()
toString: ƒ toString()
valueOf: ƒ valueOf()
__defineGetter__: ƒ __defineGetter__()
__defineSetter__: ƒ __defineSetter__()
__lookupGetter__: ƒ __lookupGetter__()
__lookupSetter__: ƒ __lookupSetter__()
__proto__: (...)　　　/* ここにあった。これがこのオブジェクトのプロトタイプを指し示すプロパティか。
get __proto__: ƒ __proto__()
set __proto__: ƒ __proto__()
```

以下引用。
```
オブジェクトのプロトタイプを指し示すプロパティは prototype という名前ではありません。
その名前は標準ではありませんが、
実際にはすべてのブラウザーが __proto__ を使用しています。
```

### オブジェクトプロトタイプ

`Object.getPrototypeOf()メソッド`は`Object.prototype`と呼ばれるオブジェクトに属する。(`Object.prototype`は、Objectオブジェクトのprototypeプロパティってことなんだろうか。よくわからんな)

また、`Object.prototypeオブジェクト`は、**すべてのオブジェクトがデフォルトで持つ、最も基本的なプロトタイプである。**

そして、`Object.prototypeオブジェクト`のプロトタイプは`null`であり、そこが**プロトタイプの連鎖の終わり**となる。  
(ここはMDNのページに図があってそれを見た方がわかりやすい。URL:[MDN-オブジェクトのプロトタイプ](https://developer.mozilla.org/ja/docs/Learn/JavaScript/Objects/Object_prototypes))

### プロトタイプを自分で設定する

JavaScriptではオブジェクトのプロトタイプを自由に設定するとことができる。

大きくわけて2つの方法がある。

||プロトタイプを設定する方法|
|-|-|
|①|`Object.create()メソッド`を使用する|
|②|コンストラクターを使用する (`Object.assign()メソッド`を使う)|

順番に見ていく。

まず、`Object.create()メソッド`を使用する方法から。

**・Object.create()メソッドを使用する**

`Object.create()メソッド`は、**新しいオブジェクトを作成し、その新しいオブジェクトのプロトタイプとして使用するオブジェクトを指定することができる。**

使うには以下のように書く。

```
Object.create(プロトタイプとして使用したいオブジェクト名);
```

実際に使ってみる。以下のコードを書く。

```
const personPrototype = {
  greet() {
    console.log("hello!");
 }
};

const carl = Object.create(personPrototype); /* carlは人名。
```

動作を確認するには以下のコードを書く。

```
carl.greet(); /* 出力結果:hello!
```


**上記のコードで何が起こったのか**

`const carl = Object.create(personPrototype);`を書くことで何が行われたのかを以下の表にまとめてみた。

||処理の内容|
|-|-|
|①|まずcarlオブジェクトが作成され、`Object.create()メソッド`によってcarlオブジェクトのプロトタイプに`personPrototypeオブジェクト`が紐づけられる。|
|②|呼び出す時に`carl.greet();`と書くことで、まずcarlオブジェクト内で`greet()メソッド`が検索され、見つからなかったので、次にcarlオブジェクトのプロトタイプとして設定されている`personPrototypeオブジェクト`内で検索がなされ、無事見つかったので実行されるという流れになる。|

**・コンストラクターを使用する**

プロトタイプを自分で設定する方法の2つ目、コンストラクターを使用する場合を見ていく。

まず前提知識として以下の内容をおさえておく必要がある。
```
JavaScript では、すべての関数が prototype という名前のプロパティを持っています。
関数をコンストラクターとして呼び出すと、
このプロパティが新しく構築されるオブジェクトのプロトタイプとして設定されます
（規約では __proto__ というプロパティに設定されています）。
```

上記の引用のうち`JavaScript では、すべての関数が prototype という名前のプロパティを持っています。`という部分は、上の方で先程やった時に出てきた以下の記述からも確認できる。

```
これは Object.prototype と呼ばれるオブジェクトで、すべてのオブジェクトがデフォルトで持つ、最も基本的なプロトタイプです。
```

つまり、まとめると以下になる。

||内容|
|-|-|
|まとめ|すべてのオブジェクトはデフォルトで`Object.prototype`と呼ばれる最も基本的なプロトタイプを持っている。`Object.prototype`は言葉に直すと「Objectオブジェクトのprototypeプロパティ」となるため、すべてのオブジェクトが`Object.prototype`を持っているということは同時に`prototypeプロパティ`も持っているといえる。なのでオブジェクトの一種である関数も`prototypeプロパティ`を持っているということになる。|

もうひとつ前提知識として、**`Object.assign()メソッド`の使い方**も解説しておく。

まず、`Object.assign()メソッド`とはどういうメソッドかというと、「プロパティの値をコピー元オブジェクトからコピー先オブジェクトへとコピーする」という機能を持つ。(コピー元オブジェクトは複数指定可能) そして、コピーが終わると最終的に変更されたコピー先オブジェクトを戻り値として返す。

**構文**
```
Object.assign(target, source); /* sourceの部分にコピー元のオブジェクト名を、targetの部分にコピー先のオブジェクト名を書く
　　　　　　　　　　　　　　　　　　　つまり、右から「コピー元->コピー先」の順番
```

それでは前提知識の解説が終わったので、ここから`Object.assign()メソッド`を使用して、コンストラクターで作成するすべてのオブジェクトに特定の機能(プロトタイプ)を付与していく。

以下のコードを書く。

```
const personPrototype = {
  greet() {
    console.log(`hello, my name is ${this.name}!`);
  },
};

function Person(name) {  /* この関数は「コンストラクター関数」といって、コンストラクター用の関数
  this.name = name;
}

Object.assign(Person.prototype, personPrototype);
```


